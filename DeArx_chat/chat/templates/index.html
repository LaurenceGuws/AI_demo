<!DOCTYPE html>
<html>
<head>
    <title>Chatbot</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div id="conversationsPane">
        <h2>Conversations</h2>
        <!-- Buttons will be added here dynamically -->
    </div>
    <div id="mainContent">
        <div id="chatbox">
            <h2>Chat</h2>
            <!-- ... rest of your HTML ... -->
        </div>
        <form id="messageForm">
            <textarea id="messageInput" placeholder="Type your message here..." rows="1"></textarea>
            <button type="submit">Send</button>
        </form>
        <div id="optionsPane">
            <div id="dropdownContainer">
                <button id="optionsButton">&#8942;</button>
                <div id="optionsDropdown">
                    <a href="#" id="changeModel">Change AI Model</a>
                    <a href="#" id="customInstructions">Custom Instructions</a>
                    <a href="#" id="uploadLink">Upload a File</a>
                </div>
            </div>
            <form id="modelForm">
                <select>
                  <option value="gpt-3.5-turbo">GPT-3.5</option>
                  <option value="bard">Bard</option>
                  <!-- Add other model options here -->
                </select>
                <input type="submit" value="Change Model">
            </form>
        </div>
        <form id="modelForm" style="display: none;">
            <select>
              <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
              <!-- Add other model options here -->
            </select>
            <input type="submit" value="Change Model">
          </form>
        <input type="file" id="fileUpload" style="display: none;">
        <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#optionsButton').click(function(event) {
                event.stopPropagation();
                $('#optionsDropdown').toggle();
            });
            $(document).click(function() {
                $('#optionsDropdown').hide();
            });
            $('#uploadLink').click(function(event) {
                event.preventDefault();
                $('#fileUpload').click();
            });
            });
            $('#fileUpload').change(function() {
                var formData = new FormData();
                formData.append('file', $(this)[0].files[0]);
                $.ajax({
                    url: '/upload',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function(response) {
                        alert(response);
                        $('#fileUpload').val(''); // Clear the input
                    },
                    error: function(jqXHR, textStatus, errorMessage) {
                        alert('Error uploading: ' + errorMessage);
                    }
                });
            });
        });
    
    $("#modelForm").submit(function(e) {
        e.preventDefault();  // Prevent the default form submission behaviour
        var selectedModel = $(this).find("select").val();  // Get the selected model

        $.ajax({
            url: '/change_model',  // The endpoint on the server that changes the AI model
            type: 'POST',
            data: { 'model': selectedModel },  // Send the selected model as data
            success: function(response) {
                alert(response);  // Show a success message
            },
            error: function(jqXHR, textStatus, errorMessage) {
                alert('Error changing model: ' + errorMessage);  // Show an error message
            }
        });
    });
</script>
</body>
</html>